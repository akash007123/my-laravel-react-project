import{r,a as G,j as e,H as L,b as j}from"./app-Bp6DQhxw.js";import{A as q,X as D}from"./app-layout-D8C2hzwB.js";import{P as S}from"./plus-Dhmb4Xu8.js";import{c as H}from"./createLucideIcon-OSqK8dsf.js";import{T as B}from"./trash-2-DbdFrQTs.js";/* empty css            */import"./button-BbeW9tRv.js";import"./index-DrNIxP88.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],E=H("Pen",O);function $({user:I,gallery:y=[]}){const[N,u]=r.useState(!1),[s,c]=r.useState(null),[a,x]=r.useState(!1),[i,h]=r.useState(!1),[M,p]=r.useState(!1),[o,g]=r.useState(null);function U(t){g(t),p(!0)}function _(){o&&o.id&&j.post(route("gallery.destroy",o.id),{_method:"delete"},{onSuccess:()=>{p(!1),g(null)}})}const{data:d,setData:b,post:R,processing:n,errors:m,reset:v}=G({title:"",image:null});function P(){u(!0),x(!1),v()}function w(t){b({title:t.title||"",image:null}),c(t),x(!0),u(!0)}function z(t){c(t)}function f(){u(!1),c(null),x(!1),v(),h(!1)}function F(){"caches"in window&&caches.keys().then(t=>{t.forEach(l=>caches.delete(l))}).catch(t=>{console.warn("Cache clearing failed:",t)})}function T(t){t.preventDefault(),h(!0);const l=new FormData;l.append("title",d.title||""),d.image&&l.append("image",d.image);const k=()=>{f(),F(),a||window.location.reload()},C=A=>{h(!1),console.error("Form submission failed:",A)};a&&(s!=null&&s.id)?(l.append("_method","PUT"),j.post(route("gallery.update",s.id),l,{forceFormData:!0,onSuccess:k,onError:C})):j.post(route("gallery.store"),l,{forceFormData:!0,onSuccess:k,onError:C})}return e.jsxs(q,{user:I,children:[e.jsx(L,{title:"Gallery"}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gallery"}),e.jsxs("button",{onClick:P,className:"cursor-pointer px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Add"]})]}),y.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-600",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No gallery items yet."}),e.jsx("p",{className:"text-sm mt-2",children:'Click the "Add" button to upload your first image.'})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:y.map((t,l)=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden group",children:[t.image_url?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.image_url,alt:t.title??"Image",className:"w-full h-48 object-cover cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>z(t)}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>w(t),className:"cursor-pointer bg-black/50 text-white p-2 rounded-full","aria-label":"Edit",children:e.jsx(E,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>U(t),className:"cursor-pointer bg-black/50 text-white p-2 rounded-full","aria-label":"Delete",children:e.jsx(B,{className:"w-4 h-4"})})]})]}):e.jsx("div",{className:"w-full h-48 bg-gray-100 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"No image"})}),e.jsxs("div",{className:"p-4",children:[t.title&&e.jsx("div",{className:"text-sm font-medium text-gray-800 mb-1",children:t.title}),t.uploader&&e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("b",{children:"Uploaded by"}),"  ",e.jsx("span",{className:"text-blue-500",children:e.jsxs("strong",{children:["➺  ",t.uploader]})})]})]})]},t.id??l))})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md p-6 relative",children:[e.jsx("button",{onClick:f,className:"cursor-pointer absolute top-3 right-3 text-gray-500 hover:text-gray-700","aria-label":"Close",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:a?"Edit Image":"Upload Image"}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:d.title,onChange:t=>b("title",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:n||i}),m.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.title})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Image ",a?"":"*"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>{var l;return b("image",((l=t.target.files)==null?void 0:l[0])||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!a,disabled:n||i}),m.image&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.image}),a&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to keep current image"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",disabled:n||i,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:n||i,className:"cursor-pointer px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center",children:n||i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"⏳"}),a?"Updating...":"Uploading..."]}):a?"Update":"Upload"})]})]})]})}),s&&!N&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-3xl max-h-[90vh] overflow-hidden relative",children:[e.jsx("button",{onClick:()=>c(null),className:"cursor-pointer absolute top-3 right-3 text-white bg-black/20 hover:bg-black/40 rounded-full p-2 z-10","aria-label":"Close",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>w(s),className:"cursor-pointer absolute top-3 right-16 text-white bg-black/20 hover:bg-black/40 rounded-full p-2 z-10","aria-label":"Edit",children:e.jsx(E,{className:"w-5 h-5"})}),s.image_url&&e.jsx("img",{src:s.image_url,alt:s.title??"Image",className:"w-full h-auto max-h-[70vh] object-contain"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:s.title}),s.uploader&&e.jsxs("p",{className:"text-gray-600",children:["Uploaded by ",s.uploader]})]})]})}),M&&o&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Image"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:['Are you sure you want to delete "',o.title||"Untitled",'"?']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{p(!1),g(null)},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:_,className:"cursor-pointer px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"})]})]})})]})}export{$ as default};
