import{u as H,r as l,b as o,a as C,j as e,H as M}from"./app-Bp6DQhxw.js";import{A as O}from"./app-layout-D8C2hzwB.js";import{C as P}from"./country-DzBn4kkS.js";import{renderFlag as j,formatDateTime as U}from"./utils-C4eYD4bF.js";/* empty css            */import"./button-BbeW9tRv.js";import"./index-DrNIxP88.js";import"./createLucideIcon-OSqK8dsf.js";function W(){const{auth:S,flash:r,leads:c,filters:n}=H().props,[k,i]=l.useState(!1),[h,m]=l.useState(null),[x,y]=l.useState(null),[u,D]=l.useState((n==null?void 0:n.search)||""),[b,L]=l.useState((n==null?void 0:n.sortBy)||"created_at"),[g,E]=l.useState((n==null?void 0:n.sortDir)||"desc"),[f,N]=l.useState((r==null?void 0:r.success)??null);l.useEffect(()=>{if(r!=null&&r.success){N(r.success);const t=setTimeout(()=>N(null),3e3);return()=>clearTimeout(t)}},[r==null?void 0:r.success]);const v=l.useMemo(()=>P.getAllCountries().map(t=>({code:t.isoCode,name:t.name,flag:`https://flagcdn.com/24x18/${t.isoCode.toLowerCase()}.png`})),[]);l.useEffect(()=>{const t=setTimeout(()=>{o.get(route("leads.index"),{search:u,sortBy:b,sortDir:g},{preserveState:!0,replace:!0})},350);return()=>clearTimeout(t)},[u]);function F(t){const p=b===t&&g==="asc"?"desc":"asc";L(t),E(p),o.get(route("leads.index"),{search:u,sortBy:t,sortDir:p},{preserveState:!0,replace:!0})}const s=C({full_name:"",email:"",company_name:"",country:""}),a=C({full_name:"",email:"",company_name:"",country:""});function A(t){t.preventDefault(),s.post(route("leads.store"),{preserveScroll:!0,onSuccess:()=>{i(!1),s.reset()}})}function T(t){m(t),a.setData({full_name:t.full_name,email:t.email,company_name:t.company_name||"",country:t.country||""})}function q(t){t.preventDefault(),h&&o.post(route("leads.update",h.id),{...a.data,_method:"put"},{preserveScroll:!0,onSuccess:()=>m(null)})}function B(){x&&o.post(route("leads.destroy",x.id),{_method:"delete"},{preserveScroll:!0,onSuccess:()=>y(null)})}function _(t){t&&o.visit(t,{preserveState:!0})}function d({column:t,children:p}){const w=b===t,z=w?g==="asc"?"▲":"▼":"";return e.jsxs("button",{onClick:()=>F(t),className:`flex items-center gap-1 ${w?"text-blue-700":"text-gray-700"} hover:text-blue-800`,children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider",children:p}),e.jsx("span",{className:"text-[10px]",children:z})]})}return e.jsxs(O,{user:S.user,children:[e.jsx(M,{title:"Leads"}),e.jsxs("div",{className:"container mx-auto px-4 py-8 overflow-x-hidden",children:[f&&e.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-800 rounded-md p-3",children:f}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Leads"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:u,onChange:t=>D(t.target.value),placeholder:"Search name, email, company...",className:"px-3 py-2 border border-gray-300 rounded-md w-64"}),e.jsx("button",{onClick:()=>i(!0),className:"cursor-pointer px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"New Lead"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx(d,{column:"full_name",children:"Name"})}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx(d,{column:"email",children:"Email"})}),e.jsx("th",{className:"px-6 py-3 text-left hidden sm:table-cell",children:e.jsx(d,{column:"company_name",children:"Company"})}),e.jsx("th",{className:"px-6 py-3 text-left hidden md:table-cell",children:e.jsx(d,{column:"country",children:"Country"})}),e.jsx("th",{className:"px-6 py-3 text-left hidden lg:table-cell",children:e.jsx(d,{column:"created_at",children:"Created"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No leads found."})}):c.data.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-[160px] truncate",children:t.full_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-[220px] truncate",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 hidden sm:table-cell max-w-[200px] truncate",children:t.company_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 hidden md:table-cell",children:e.jsxs("div",{className:"flex items-center gap-2",children:[j(t.country),e.jsx("span",{children:t.country||"-"})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 hidden lg:table-cell",children:U(t.created_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>T(t),className:"cursor-pointer text-blue-600 hover:text-blue-800",children:"Edit"}),e.jsx("button",{onClick:()=>y(t),className:"cursor-pointer text-red-600 hover:text-red-800",children:"Delete"})]})})]},t.id))})]})})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("button",{onClick:()=>_(c.prev_page_url),className:"cursor-pointer px-3 py-1 border rounded disabled:opacity-50",disabled:!c.prev_page_url,children:"Previous"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",c.current_page," of ",c.last_page]}),e.jsx("button",{onClick:()=>_(c.next_page_url),className:"cursor-pointer px-3 py-1 border rounded disabled:opacity-50",disabled:!c.next_page_url,children:"Next"})]})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md p-6 relative",children:[e.jsx("button",{onClick:()=>i(!1),className:"cursor-pointer absolute top-3 right-3 text-gray-500 hover:text-gray-700","aria-label":"Close",children:"×"}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"New Lead"}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",value:s.data.full_name,onChange:t=>s.setData("full_name",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0}),s.errors.full_name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.errors.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:s.data.email,onChange:t=>s.setData("email",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0}),s.errors.email&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.errors.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),e.jsx("input",{type:"text",value:s.data.company_name,onChange:t=>s.setData("company_name",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),s.errors.company_name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.errors.company_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:s.data.country,onChange:t=>s.setData("country",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md appearance-none pr-10",children:[e.jsx("option",{value:"",children:"Select a country"}),v.map(t=>e.jsx("option",{value:t.name,children:t.name},t.code))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center",children:j(s.data.country)})]}),s.errors.country&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.errors.country})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:s.processing,className:"cursor-pointer px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:s.processing?"Creating...":"Create"})]})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md p-6 relative",children:[e.jsx("button",{onClick:()=>m(null),className:"cursor-pointer absolute top-3 right-3 text-gray-500 hover:text-gray-700","aria-label":"Close",children:"×"}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Edit Lead"}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",value:a.data.full_name,onChange:t=>a.setData("full_name",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0}),a.errors.full_name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:a.errors.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:a.data.email,onChange:t=>a.setData("email",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0}),a.errors.email&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:a.errors.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),e.jsx("input",{type:"text",value:a.data.company_name,onChange:t=>a.setData("company_name",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),a.errors.company_name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:a.errors.company_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text_sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:a.data.country,onChange:t=>a.setData("country",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md appearance-none pr-10",children:[e.jsx("option",{value:"",children:"Select a country"}),v.map(t=>e.jsx("option",{value:t.name,children:t.name},t.code))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center",children:j(a.data.country)})]}),a.errors.country&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:a.errors.country})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>m(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a.processing,className:"cursor-pointer px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:a.processing?"Updating...":"Update"})]})]})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w_full max-w-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Lead"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Are you sure you want to delete ",x.full_name,"?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>y(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:B,className:"cursor-pointer px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"})]})]})})]})}export{W as default};
